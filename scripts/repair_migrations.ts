
const migrations = [
    '20240114000000',
    '20240114100000',
    '20240114100001',
    '20240114100002',
    '20240114100003',
    '20240114100004',
    '20240114100005',
    '20240114100006',
    '20240114100007',
    '20240114100008',
    '20240114100009',
    '20240114100010',
    '20240115100000',
    '20240115100001',
    '20240115100002',
    '20240115100003',
    '20260115100000',
    '20260115100001',
    '20260116100000',
    '20260116100001',
    '20260116100002',
    '20260116100003',
    '20260116100004',
    '20260116100005',
    '20260116100006',
    '20260116100007',
    '20260116100008',
    '20260116100009',
    '20260117100000',
    '20260117100001',
    '20260117100002',
    '20260117100003',
    '20260120100000',
    '20260121100000',
    '20260121100001',
    '20260122100000',
    '20260122100001',
    '20260123100000',
    '20260123120000',
    '20260125100000',
    '20260126100000',
    '20260126110000',
    '20260126120000'
];

// Execute repair for each
import { exec } from 'child_process'

const run = async () => {
    console.log('Repairing ' + migrations.length + ' migrations...')
    for (const m of migrations) {
        await new Promise((resolve) => {
            exec(`npx supabase migration repair --status applied ${m}`, (err, stdout, stderr) => {
                if (err) console.error(`Error on ${m}:`, stderr)
                else console.log(`Repaired ${m}`)
                resolve(null)
            })
        })
    }
}
run()
